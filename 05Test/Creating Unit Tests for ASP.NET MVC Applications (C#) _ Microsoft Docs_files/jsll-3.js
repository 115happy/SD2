(function(n){n.fn.extend({inViewport:function(t){var i=this.filter(function(){return n.inViewport(this,t)});return this.pushStack(i)},mostVisible:function(){var u=this.inViewport(),i=0,t,r;return u.each(function(u,f){t=n(f).data("vpVisibility");t>i&&(i=t,r=f)}),n(r)}});var t={offsetTop:0,offsetBottom:0};n.inViewport=function(i,r){var e=n(i),f,h,c,u,l,o,a,v,y,s;return f=n.extend({},t,r||{}),h=n(window).scrollTop(),c=n(window).height()-f.offsetTop-f.offsetBottom,u=e.height(),l=e.offset(),o=l.top-h-f.offsetTop,a=o+u,v=Math.max(0,Math.min(o-(c-u),u)),y=Math.max(0,Math.min(a,u)),s=(y-v)/u,e.data("vpVisibility",s),s}})(jQuery);
var Asimov={};Asimov.cookie=function(){function r(t,i){var e=n(t),f,r,u;if(e&&i)for(f=e.split("&"),r=0;r<f.length;r++)if(u=f[r].split("="),u[0]&&i.toLowerCase()===u[0].toLowerCase())return u[1];return null}function n(n){for(var f=document.cookie.split(";"),i,u,e,r=0;r<f.length;r++){for(i=f[r];i.charAt(0)==" ";)i=i.substring(1);if(u=i.split("="),e=t(u.shift()),e===n)return t(u.join("="))}return null}function t(n){var t=decodeURIComponent(n.replace("/+/g"," "));return t.indexOf('"')===0&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),t}function i(n,t,i){var u,r;i?(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toUTCString()):u="";window.document.cookie=n+"="+t+u+"; path=/;"}function u(n){i(n,"",-1)}return{getCookie:n,getCookieKeyValue:r,setCookie:i,deleteCookie:u}}();Asimov.CorrelationVector=function(){function u(){var t=n();return i(t)?!0:!1}function n(){var n=r.concat(".",t);if(i(n))return n}function s(){var t=n();return i(t)?t.length+2<=f:!1}function h(){return i(n())?r.length+1+(t+1+"").length<=f:!1}function l(u){if(i(u)){var f=u.lastIndexOf(".");r=u.substr(0,f);t=parseInt(u.substr(f+1),10)}else Asimov.logger.logWarning("Cannot set invalid correlation vector value");return n()}function o(){return r=v(),n()}function a(){var n=$("meta[name='ms.Cv']").attr("content");if(i(n))return n}function v(){for(var t="",n=0;n<16;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function y(){return u()||o(),s()&&(r=r.concat(".",t),t=0),n()}function p(){return u()||o(),h()&&(t=t+1),n()}function i(n){return c.test(n)&&n.length<=f}function w(){return u()?n():a()}var r="",t=0,f=63,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=new RegExp("^["+e+"]{16}(.[0-9]+)+$");return{header:"MS-CV",tag:"cV",isInit:u,canExtend:s,canIncrement:h,getValue:n,setValue:l,init:o,extend:y,increment:p,isValid:i,idsGetCv:w}}();Asimov.cv=Asimov.CorrelationVector;Asimov.correlationVectorTag=Asimov.CorrelationVector.tag;Asimov.correlationVectorHeader=Asimov.CorrelationVector.header;Asimov.logger=function(){function n(n){Asimov.consoleVerbosity>=Asimov.verbosityLevels.ERROR&&console&&console.error&&console.error("JSLL: "+n)}function t(n){Asimov.consoleVerbosity>=Asimov.verbosityLevels.WARNING&&console&&console.warn&&console.warn("JSLL: "+n)}function i(n){Asimov.consoleVerbosity>=Asimov.verbosityLevels.INFORMATION&&console&&console.log&&console.log("JSLL: "+n)}return{logError:n,logWarning:t,logInformation:i}}();Asimov.capabilitiesCheck=function(){return function(){return typeof jQuery=="undefined"?(Asimov.logger.logError("Unable to write event: jQuery is not present"),Asimov.isAvailable=!1,!1):jQuery.fn.jquery<Asimov.jQueryMinSupportedVersion?(Asimov.logger.logError("Unable to write event: Minimum version of jQuery "+Asimov.jQueryMinSupportedVersion+" required."),Asimov.isAvailable=!1,!1):!JSON||!JSON.stringify?(Asimov.logger.logError("Unable to write event: the global JSON.stringify method does not exist"),Asimov.isAvailable=!1,!1):void 0}}();Asimov.utils=function(){function n(n,i){var r,u,f;if(i)try{return(r=JSON.stringify(i),r=="{}"&&n=="timing")?t():r}catch(e){return u='{"error": "ERROR: could not stringify {0} {1}"}',f=typeof i=="string"?i:"",u.replace("{0}",n).replace("{1}",f)}}function t(){for(var t=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],i="{",r,n=0;n<t.length;n++)r=window.performance.timing[t[n]],typeof r!="undefined"&&(i+='"'+t[n]+'":'+r),n<t.length-1&&(i+=",");return i+"}"}function i(n){return{"microsoft.com":"c1.microsoft.com","xbox.com":"c.xbox.com","live.com":"c.live.com","microsoftstore.com":"c.microsoftstore.com","msn.com":"c.msn.com","windows.com":"c.windows.com"}[n]}function r(n,t){if(n=="string")return typeof t=="string"||t instanceof String||t instanceof Date;if(n=="bool")return typeof t=="boolean"||t instanceof Boolean;if(!(typeof t=="number"||t instanceof Number))return!1;if(n=="uint8"){if(t<0||t>255||t%1!=0)return!1}else if(n=="uint16"){if(t<0||t>65535||t%1!=0)return!1}else if(n=="uint32"){if(t<0||t>4294967295||t%1!=0)return!1}else if(n=="uint64"){if(t<0||t>18446744073709551615||t%1!=0)return!1}else if(n=="int8"){if(t<-128||t>127||t%1!=0)return!1}else if(n=="int16"){if(t<-32768||t>32767||t%1!=0)return!1}else if(n=="int32"){if(t<-2147483648||t>2147483647||t%1!=0)return!1}else if(n=="int64"){if(t<-9223372036854775808||t>9223372036854775807||t%1!=0)return!1}else if(n=="float"){if(t<-3402823e32||t>3402823e32)return!1}else if(n=="double"&&(t<Number.MIN_VALUE||t>Number.MAX_VALUE))return!1;return!0}return{stringifyField:n,getMuidHost:i,isOfCorrectType:r}}();Asimov.ids=function(){function i(){return n.getCookie("MS0")}function r(){return n.getCookie("MUID")}function u(){return t}function f(n){t=n}function e(){return n.getCookie("Flights")}function o(){return n.getCookie("Treatments")}var t,n=Asimov.cookie;return{getSessionId:i,getVisitorId:r,setImpressionGuid:f,getImpressionGuid:u,getCv:Asimov.CorrelationVector.idsGetCv,getFlights:e,getGroups:o,setCVValue:Asimov.CorrelationVector.setValue}}();Asimov.vortexEvents=function(){function e(){i.length>0&&(Asimov.writeEvent(i),i=[])}function t(t,o,s){o||(o=u.idsGetCv());u.isValid(o)&&(t[u.tag]=o);r&&(t.appId=r);var h=n.getGroups();if(h&&(t.expId=h),s===!0){Asimov.writeEvent(t);return}if(f){if(f==="complete"){Asimov.writeEvent(t);return}}else if(document.readyState==="complete"){Asimov.writeEvent(t);return}i.length===0&&(window.addEventListener?window.addEventListener("load",e):window.attachEvent&&window.attachEvent("onload",e));i.push(t)}function o(i){var r={name:"Ms.Webi.PageView",content:{"Ms.Content.PageView":{uri:i.pageUri,pageName:i.pageName,referrerUri:i.referrerUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content,product:i.product,pageType:i.pageType,screenState:i.screenState},"Ms.Webi.PageView":{flightId:i.flightId,utcOffset:i.utcOffset,languages:navigator.userLanguage,slInstalled:i.slInstalled,slEnabled:i.slEnabled,slVersion:i.slVersion,flashInstalled:i.flashInstalled,flashVersion:i.flashVersion,pageLoadTime:i.pageLoadTime,signInStatus:i.signInStatus,cookies:i.cookies,cookieEnabled:i.cookieEnabled,isJs:i.isJs,title:i.title,screenRes:i.screenRes,browserSize:i.browserSize}}};t(r,null,!0)}function s(i){var r={name:"Ms.Webi.PartialPageView",content:{"Ms.Content.PageView":{uri:i.pageUri,pageName:i.pageName,referrerUri:i.referrerUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content},"Ms.Webi.PartialPageView":{}}};t(r)}function h(i){var r={name:"Ms.Webi.ContentView",content:{"Ms.Content.PageView":{uri:i.pageUri,pageName:i.pageName,referrerUri:i.referrerUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content,product:i.product,pageType:i.pageType,screenState:i.screenState},"Ms.Webi.ContentView":{flightId:i.flightId,utcOffset:i.utcOffset,languages:navigator.userLanguage,slInstalled:i.slInstalled,slEnabled:i.slEnabled,slVersion:i.slVersion,flashInstalled:i.flashInstalled,flashVersion:i.flashVersion,pageLoadTime:i.pageLoadTime,signInStatus:i.signInStatus,cookies:i.cookies,cookieEnabled:i.cookieEnabled,isJs:i.isJs,title:i.title,screenRes:i.screenRes,browserSize:i.browserSize}}};t(r)}function c(i){var r={name:"Ms.Webi.PageAction",content:{"Ms.Content.PageAction":{uri:i.pageUri,pageName:i.pageName,destUri:i.targetUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content,product:i.product,pageType:i.pageType,screenState:i.screenState,actionInputMethod:i.inputMethod,behavior:i.behavior},"Ms.Webi.PageAction":{flightId:i.flightId,timeToAction:i.timeToAction,scrollCount:i.scrollCount,languages:navigator.userLanguage,cookies:i.cookies,cookieEnabled:i.cookieEnabled,isJs:i.isJs,title:i.title,screenRes:i.screenRes,browserSize:i.browserSize,referrerUri:i.referrerUri}}};t(r,null,!0)}function l(n){var i={};n.type==="CorsDisallowed"?i={name:"Ms.Cll.Javascript.CorsDisallowed",content:{"Ms.Cll.Javascript.CorsDisallowed":{eventName:n.eventName}}}:n.type==="EventTooLong"&&(i={name:"Ms.Cll.Javascript.EventTooLong",content:{"Ms.Cll.Javascript.EventTooLong":{eventName:n.eventName,payloadLength:n.payloadLength}}});t(i)}function a(i,r){var u={name:"Ms.Webi.ClientError",content:{"Ms.Webi.ClientError":{errorInfo:JSON.stringify(i),wasDisplayed:r||!1,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid()}}};t(u)}function v(i){var r={name:"Ms.Webi.OutgoingRequest",content:{"Ms.Qos.OutgoingServiceRequest":{operationName:i.currentOperationName,targetUri:i.requestUri,latencyMs:i.latencyMs,serviceErrorCode:i.serviceErrorCode||-1,succeeded:i.isSuccess,requestMethod:i.httpMethod,responseContentType:i.contentType,protocolStatusCode:i.httpStatusCode||"",dependencyOperationName:i.operationName,dependencyOperationVersion:i.operationVersion,dependencyName:i.serviceName,dependencyType:i.serviceType||"WebService",responseSizeBytes:i.responseSize},"Ms.Webi.OutgoingRequest":{customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),message:i.errorMessage,retryCount:i.retryCount,customData:i.customData}}};t(r,i.cV)}var r,n=Asimov.ids,u=Asimov.CorrelationVector,i=[],f=null;return{setAppId:function(n){r=n},sendError:a,sendPageAction:c,sendPageView:o,sendApiComplete:v,sendPartialPageView:s,sendContentView:h,sendJsllEvent:l,overrideQueueBehavior:function(n){n&&n.domReadyState&&(f=n.domReadyState)}}}();Asimov.createGuid=function(){return function(){function n(){return Math.floor(Math.random()*16).toString(16)}var t="xxxxxxxx-xxxx-4xxx-Rxxx-xxxxxxxxxxxx".replace(/x/g,n);return t.replace("R",(8|Math.floor(Math.random()*3)).toString(16))}}();Asimov.errorHandler=function(){function t(n){var t=window.onerror;window.onerror=function(){t&&t.apply(this,arguments);n.apply(this,arguments)}}function i(){if(arguments){var t={Page:window.location.href,Script:arguments[1]||"",Message:arguments[0]||"",LineNumber:arguments[2]||0,UserAgent:window.navigator.userAgent||"",Platform:window.navigator.platform||""};n.sendError(t,!1)}}function r(){t(i)}var n=Asimov.vortexEvents;return{init:r}}();Asimov.timespanHandler=function(){function t(t,i){var r=(new Date).getTime();if(i)return r-n[t];n[t]=r}var n={};return{recordTimeSpan:t}}(),function(){function nt(){function i(){var i=Asimov.cookie.getCookie(n);return i&&i.length?t+i:""}var n="MUID",t="t:";return i()}function h(n){var i,t,r;o++;i="telframe"+o;t=document.createElement("iframe");t.id=i;t.style.display="none";Asimov.OnSuccessfulVortexRequest&&(t.attachEvent?t.attachEvent("onload",function(){Asimov.OnSuccessfulVortexRequest(n)}):t.onload=function(){Asimov.OnSuccessfulVortexRequest(n)});t.src=n;document.body.appendChild(t);o>u&&(r="telframe"+(o-u),$("#"+r).remove())}function ut(){if(u<t.length){Asimov.logger.logInformation("Increasing maxTelemetryFrames value to "+t.length);var n=u;u=t.length;setTimeout(function(){u=n},30)}while(t.length>0)h(t[0]),t.shift();setTimeout(function(){l=!1},18e5)}function ft(){var n=window.navigator.userAgent,t=n.indexOf("MSIE ");return t>0?parseInt(n.substring(t+5,n.indexOf(".",t)),10)<9:!1}var y,c,p;Asimov._schemas=Asimov._schemas||[];Asimov.uploadUrl="https://web.vortex.data.microsoft.com/collect/v1";Asimov.commonSchemaEnvelopeVersion="2.1";Asimov.jsllVersion="3.3.1";Asimov.experimentIdTag="expId";Asimov.userId=nt();Asimov.getMethodQueryStringParameter="json";Asimov.jQueryMinSupportedVersion="1.11.0";Asimov.isAvailable=!0;Asimov.SignInStatus=-1;var w="JS:",e="appId",d=ft(),g=d?2083:15e3,n="",o=0,u=5,i="",t=[],l=!1;Asimov.getRequestBody=function(){return i};Asimov.getQueryStringParameters=function(){return n};Asimov.verbosityLevels={NONE:0,ERROR:1,WARNING:2,INFORMATION:3};Object.freeze&&Object.freeze(Asimov.verbosityLevels);Asimov.consoleVerbosity=Asimov.verbosityLevels.NONE;Asimov.capabilitiesCheck();var a=window.XDomainRequest?"XDomainRequest":"jQuery",f="Unknown",s=window.navigator&&window.navigator.appVersion?window.navigator.appVersion:"";s.indexOf("Win")!=-1?f="Windows":s.indexOf("Mac")!=-1?f="MacOS":s.indexOf("X11")!=-1?f="Unix":s.indexOf("Linux")!=-1&&(f="Linux");var tt=function(){return a=="XDomainRequest"&&Asimov.uploadUrl&&Asimov.uploadUrl.indexOf(window.location.protocol)!=0?(Asimov.logger.logError("Unable to write event: CORS requests are not supported cross-protocol in this browser"),!1):!0},b=function(n,t,i){Asimov.logger.logError("Failure sending data to vortex: "+t+"Error: "+i)},v=function(n){Asimov.OnSuccessfulVortexRequest&&Asimov.OnSuccessfulVortexRequest(n);Asimov.logger.logInformation("Success sending data to vortex")},it=function(n){Asimov.logger.logError("Failure sending data to vortex using XDomainRequest.  Status code:"+n.status)},r=function(t,i,r){if(i!=undefined&&(r||i.length!=0)){var u=r?"":"'";n.length>0&&(n+="&");n+=t+"="+u+encodeURIComponent(i)+u}},k=function(n,t,i,u){for(var b=u=="C"?"*":"-",h=t.fields,f,e,a,s,v,o,y,p,w,l,c=0;c<h.length;c++){if(f=h[c],e=i[f.name],r(b+f.name,e,f.type!="string"),e===null||e===undefined){if(f.req)return Asimov.logger.logError("Missing required property: "+f.name),!1;continue}if(f.type=="map"){a={};for(s in e){if(!Asimov.utils.isOfCorrectType(f.key,s))return Asimov.logger.logError("A key in the map was of the wrong type: "+f.name),!1;if(!Asimov.utils.isOfCorrectType(f.element,e[s]))return Asimov.logger.logError("A value in the map was of the wrong type: "+f.name),!1;a[s]=e[s]}n[f.name]=a}else if(f.type=="list"||f.type=="set"){if(v=[],Object.prototype.toString.call(e)==="[object Array]")for(o=0;o<e.length;o++){if(e[o]!=null&&!Asimov.utils.isOfCorrectType(f.element,e[o]))return Asimov.logger.logError("The list contains a value of the wrong type: "+f.name),!1;v[o]=e[o]}else return Asimov.logger.logError("The "+f.type+" "+f.name+" was not an array as expected"),!1;n[f.name]=v}else if(f.type=="struct"){if(y={},!k(y,f.def,e,u))return!1;n[f.name]=y}else{if(!Asimov.utils.isOfCorrectType(f.type,e))return Asimov.logger.logError("Property is the wrong type: "+f.name),!1;n[f.name]=e}}for(p in i){for(w=!1,l=0;l<h.length;l++)if(h[l].name==p){w=!0;break}w||Asimov.logger.logError("An unexpected property was found in the event content and dropped: "+p)}return!0},rt=function(u){var s=!0,c=[],k,nt,rt,ft,f,y,et,d,p,w,ot,e,o;if(jQuery.isArray(u))for(s=!1,k=0;k<u.length;k++)nt=Asimov._validateAndTranslateEvent(u[k]),nt.success&&c.push(nt.event);else rt=Asimov._validateAndTranslateEvent(u),rt.success&&c.push(rt.event);if(c.length!=0){if(s&&n&&(ft=Asimov.uploadUrl.length+n.length,ft+7>g&&(Asimov.logger.logWarning("event is too large to send using get -- using post instead"),f={},f.eventName=u.name,f.payloadLength=ft,f.type="EventTooLong",Asimov.vortexEvents.sendJsllEvent(f),s=!1)),!s&&!tt()){f={};f.eventName=u.name;f.type="CorsDisallowed";Asimov.vortexEvents.sendJsllEvent(f);return}if(s&&n)Asimov.SignInStatus==1?(r("sauth",1,!0),y=Asimov.uploadUrl+"/t.asm?"+n,n.length>1e3?l?t&&t.length>0?t.push(y):h(y):(l=!0,t.push(y),h(Asimov.uploadUrl+"/t.asm?ver='"+Asimov.commonSchemaEnvelopeVersion+"'&name='Ms.Webi.SigningIn'&time='"+encodeURIComponent((new Date).toISOString())+"'&sauth=1"),setTimeout(ut,5e3)):h(y)):(et=Asimov.uploadUrl+"/t.gif?"+n,d=new Image,Asimov.OnSuccessfulVortexRequest&&(d.onload=function(){d.width==1&&Asimov.OnSuccessfulVortexRequest(et)}),d.src=et);else{for(i="",p=0;p<c.length;p++)p>0&&(i+="\n"),i+=JSON.stringify(c[p]);w="";Asimov.OnSuccessfulVortexRequest&&(w=Asimov.uploadUrl+"/t.req?"+i);a==="jQuery"?(ot={accepts:{text:"application/json"},url:Asimov.uploadUrl,type:"post",dataType:"text",data:i,crossDomain:!0,headers:{"Content-Type":"application/x-json-stream"}},e=window.jQuery.ajax(ot),e.fail?e.fail(function(){b}):e.error(function(){b}),e.done?e.done(function(){v(w)}):e.success(function(){v(w)})):a==="XDomainRequest"?(o=new XDomainRequest,o.onload=function(){v(w)},o.onerror=function(){it(o)},o.open("post",Asimov.uploadUrl),o.send(i)):Asimov.logger.logError("No event is sent.")}}};for(Asimov.writeEvent=function(n){rt(n)},Asimov._validateAndTranslateEvent=function(t){function o(n,t){s[n]=t;r(n,t)}var s={},c={},l={},i={event:s,success:!1},h,u,a,v,y,p,b,d,g;if(n="",!t)return Asimov.logger.logError("Unable to write null event"),i;if(!t.name)return Asimov.logger.logError("Unable to write event with missing name"),i;if(!Asimov._schemas.hasOwnProperty(t.name))return Asimov.logger.logError("Unable to write event: a schema for the event named {"+t.name+"} does not exist"),i;if(!t.content)return Asimov.logger.logError("Unable to write event: the event is missing content"),i;o("ver",Asimov.commonSchemaEnvelopeVersion);o("name",t.name);o("time",(new Date).toISOString());o("os",f);h=Asimov._schemas[t.name];for(u in h)if(u!=="name"){if(a=h[u],!t.content.hasOwnProperty(u))return Asimov.logger.logError("Unable to write event: missing expected part: "+u),i;if(a.part=="C"?v=l:(v={},l.baseData=v,l.baseType=u,r("*baseType",u)),!k(v,a.def,t.content[u],a.part))return i}for(y in t.content)h[y]&&h[y].part||Asimov.logger.logError("An unexpected property was found in the event content and dropped: "+y);if(s.data=l,s.tags={},t.hasOwnProperty(Asimov.CorrelationVector.tag))if(Asimov.CorrelationVector.isValid(t[Asimov.CorrelationVector.tag]))o(Asimov.CorrelationVector.tag,t[Asimov.CorrelationVector.tag]);else return Asimov.logger.logError("Unable to write event: The correlation vector value is invalid: "+t[Asimov.CorrelationVector.tag]),i;else Asimov.CorrelationVector.isInit()&&o(Asimov.CorrelationVector.tag,Asimov.CorrelationVector.getValue());if(t.hasOwnProperty(Asimov.experimentIdTag))if(Asimov.utils.isOfCorrectType("string",t[Asimov.experimentIdTag]))p={},b=t[Asimov.experimentIdTag],p[Asimov.experimentIdTag]=b,c.app=p,r("ext-app-"+Asimov.experimentIdTag,b);else return Asimov.logger.logError("Unable to write event: The supplied experiment id is invalid: "+t[Asimov.experimentIdTag]),i;return t.hasOwnProperty(e)?Asimov.utils.isOfCorrectType("string",t[e])?o("appId",w+t[e]):Asimov.logger.logError("Unable to write event: The supplied appId is invalid: "+t[e]):o("appId",w+window.location.hostname),d={},d.libVer=Asimov.jsllVersion,c.javascript=d,r("ext-javascript-libVer",Asimov.jsllVersion),Asimov.userId!=null&&(Asimov.utils.isOfCorrectType("string",Asimov.userId)?(g={},g.localId=Asimov.userId,c.user=g,r("ext-user-localId",Asimov.userId)):Asimov.logger.logError("ignoring the userid value because it is invalid: "+Asimov.userId)),s.ext=c,i.success=!0,i},Asimov._registerSchemas=function(n){for(var t=0;t<n.length;t++)Asimov._schemas[n[t].name]=n[t]},Asimov.console=window.console||{},Asimov.console.fallback=Asimov.console.log||function(){},y=["log","info","warn","error","trace"],c=0;c<y.length;c++)p=y[c],Asimov.console[p]||(Asimov.console[p]=Asimov.console.fallback);Date.prototype.toISOString||function(){function n(n){var t=String(n);return t.length===1&&(t="0"+t),t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+n(this.getUTCMonth()+1)+"-"+n(this.getUTCDate())+"T"+n(this.getUTCHours())+":"+n(this.getUTCMinutes())+":"+n(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}()}();Asimov._registerSchemas([{name:"Ms.Cll.Javascript.CorsDisallowed","Ms.Cll.Javascript.CorsDisallowed":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"}]}}},{name:"Ms.Cll.Javascript.EventTooLong","Ms.Cll.Javascript.EventTooLong":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"},{req:!0,name:"payloadLength",type:"int32"}]}}},{name:"Ms.Cll.Javascript.Error","Ms.Telemetry.Error":{part:"B",def:{fields:[{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}},"Ms.Cll.Javascript.Error":{part:"C",def:{fields:[{req:!0,name:"code",type:"int32"},{req:!0,name:"message",type:"string"}]}}},{name:"Ms.Webi.ClientError","Ms.Webi.ClientError":{part:"B",def:{fields:[{req:!0,name:"errorInfo",type:"string"},{name:"wasDisplayed",type:"bool"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}}},{name:"Ms.Webi.OutgoingRequest","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"Ms.Webi.OutgoingRequest":{part:"C",def:{fields:[{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"message",type:"string"},{name:"retryCount",type:"int32"},{name:"customData",type:"string"}]}}},{name:"Ms.Webi.PageAction","Ms.Content.PageAction":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"destUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"actionInputMethod",type:"int32"},{name:"behavior",type:"int32"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PageAction":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"timeToAction",type:"int32"},{name:"scrollCount",type:"int32"},{name:"languages",type:"string"},{name:"cookieEnabled",type:"bool"},{name:"cookies",type:"string"},{name:"screenRes",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"browserSize",type:"string"},{name:"referrerUri",type:"string"}]}}},{name:"Ms.Webi.PageView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PageView":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"utcOffset",type:"int32"},{name:"languages",type:"string"},{name:"cookieEnabled",type:"bool"},{name:"slInstalled",type:"bool"},{name:"slEnabled",type:"bool"},{name:"slVersion",type:"string"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"browserSize",type:"string"},{name:"cookies",type:"string"},{name:"pageLoadTime",type:"int32"},{name:"screenRes",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"signInStatus",type:"int32"}]}}},{name:"Ms.Webi.PartialPageView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PartialPageView":{part:"C",def:{fields:[]}}},{name:"Ms.Webi.ContentView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.ContentView":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"utcOffset",type:"int32"},{name:"languages",type:"string"},{name:"cookieEnabled",type:"bool"},{name:"slInstalled",type:"bool"},{name:"slEnabled",type:"bool"},{name:"slVersion",type:"string"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"browserSize",type:"string"},{name:"cookies",type:"string"},{name:"pageLoadTime",type:"int32"},{name:"screenRes",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"signInStatus",type:"int32"}]}}}]);Asimov.clickstreamTracker=function(){function o(){return typeof e=="function"?e():vt()}function vt(){var t=window.location.pathname||"Home",n=t.split("/");return n.length>2&&n[2]!==""?n[2]:"Home"}function yt(t){if(Asimov.isAvailable){if(f.setImpressionGuid(d()),a&&(Asimov.SignInStatus==1?$(document).ready(function(){h()}):h()),u=n.getMuidHost(t||"microsoft.com"),y)if(document.body)if(document.body.addEventListener){var i=navigator.appVersion.indexOf("MSIE")!=-1?"click":"mousedown";document.body.addEventListener(i,s,!1)}else document.body.attachEvent&&document.body.attachEvent("onclick",s);else $(document).click(s);w&&at.init();$(function(){p&&pt();v&&(document.readyState==="complete"?rt():$(window).load(rt))})}}function pt(){if(u){var t=(window.location.protocol||"http:")+"//"+u+"/c.gif?DI=4050&did=1&t=",n=document.createElement("IMG");n.style.display="none";n.src=t;n.hidden="";n["aria-hidden"]="true";n.role="presentation";document.body.appendChild(n)}}function s(n){for(var f={A:!0,BUTTON:!0,AREA:!0,INPUT:!0},i=n||window.event,t=i.srcElement||i.target,r,u;t&&t.tagName;)if(f[t.tagName.toUpperCase()]){r=t.tagName.toUpperCase()=="INPUT"?tt[t.type.toUpperCase()]:!0;r&&(u=$(t).attr("data-bi-dnt"),u===undefined&&c(t));break}else{t=t.parentElement||t.parentNode;continue}}function it(r,u,e){var s={},c,l,h,v,a;if(s.referrerUri=t,s.cookieEnabled=ct(),s.browserSize=ht(),s.screenRes=window.screen&&screen.width+"x"+screen.height,s.pageUri=i,s.cookies=ot(),s.flightId=f.getFlights(),s.signInStatus=Asimov.SignInStatus,s.isJs=!0,s.title=document.title,e&&(s.content=ft()),b&&(c=fi(),s.slInstalled=c.installed||!1,s.slEnabled=c.enabled||!1,s.slVersion=c.version||"",l=ui(),s.flashInstalled=l.installed||!1,s.flashVersion=l.version||""),s.pageName=o(),h={},e&&window.performance&&window.performance.timing){if(k===!0)try{v=window.performance.getEntries().filter(function(n){return n.initiatorType==="script"||n.initiatorType==="link"});h.AssetPerformance=n.stringifyField("AssetPerformance",v)}catch(y){}h.timing=n.stringifyField("timing",window.performance.timing);window.performance.timing.domComplete>0&&(s.pageLoadTime=window.performance.timing.domComplete-window.performance.timing.fetchStart)}if(h.metaTags=st(),r)for(a in r)h[a]=r[a];return s.pageTags=n.stringifyField("pageTags",h),u&&(u.pageLoadTime&&(s.pageLoadTime=u.pageLoadTime),u.referrerUri&&(s.referrerUri=u.referrerUri),u.pageUri&&(s.pageUri=u.pageUri),u.pageName&&(s.pageName=u.pageName)),s}function h(n,t){var i=it(n,t,!1);r.sendPageView(i)}function wt(u,f,e){var s={};s.referrerUri=t;s.pageUri=i;s.content=ft(u);s.pageLoadTime=f;s.pageName=o();e&&(s.pageTags=n.stringifyField("pageTags",e));r.sendPartialPageView(s)}function rt(){ut()}function ut(n,t){var i=it(n,t,!0);r.sendContentView(i)}function bt(n,t){c(null,t,n)}function kt(n,t){c(n,t,null)}function c(u,e,s){var h={},c={};h.timeToAction=dt();u?(h.targetUri=ii(u),h.content=gt(u),c=ri(u)):s&&(h.targetUri=s.targetUri,h.content=ti(s));c.metaTags=st();e&&(c=$.extend(c,e));h.pageTags=n.stringifyField("pageTags",c);h.pageUri=i;h.referrerUri=t;h.cookieEnabled=ct();h.browserSize=ht();h.screenRes=window.screen&&screen.width+"x"+screen.height;h.pageName=o();h.cookies=ot();h.flightId=f.getFlights();h.isJs=!0;h.title=document.title;r.sendPageAction(h)}function dt(){var t=(new Date).getTime(),n;return window.performance&&window.performance.timing&&(n=window.performance.timing.domComplete,n!==0)?t-n:-1}function ft(n){var e=[],u,i,r,f,t,o;for(n?(i=$("#"+n),i=i&&i.length===1&&i[0],u=$("[data-bi-slot]",$(i)).inViewport()):u=$("[data-bi-slot]").inViewport(),f=0;f<u.length;f++)t=$(u[f]),r=et(t),o={areaName:r.areaName,slotNumber:t.attr("data-bi-slot"),templateName:r.templateName,contentId:t.attr("data-bi-id")||t.attr("id"),contentName:t.attr("data-bi-name")||t.attr("name")||t.attr("alt")||"",contentSource:t.attr("data-bi-source")||r.contentSource,product:t.attr("data-bi-product")||r.product,contentType:t.attr("data-bi-type")||r.type},e.push(o);return l(e)}function gt(n){if(!n)return"";var i=et(n),u=[],r=$(n).closest("[data-bi-name]"),t=r&&r.length===1?$(r[0]):$(n),f={areaName:i.areaName,slotNumber:t.attr("data-bi-slot"),templateName:i.templateName,contentId:t.attr("data-bi-id")||n.id||"",contentName:t.attr("data-bi-name")||ni(n)||"",contentSource:t.attr("data-bi-source")||i.contentSource,product:t.attr("data-bi-product")||i.product,contentType:t.attr("data-bi-type")||i.type};return u.push(f),l(u)}function ni(n){if(nt==!0||lt(n)||!n.tagName)return"";switch(n.tagName){case"A":return document.all?n.innerText||n.innerHTML:n.text||n.innerHTML;case"IMG":case"AREA":return n.alt;default:return n.value||n.name||n.alt||n.innerText||n.id}}function et(n){var i=$(n).closest("[data-bi-area]"),t=i&&i.length===1?$(i[0]):$(n);return{areaName:t.attr("data-bi-area"),templateName:t.attr("data-bi-view"),contentSource:t.attr("data-bi-source"),product:t.attr("data-bi-product"),type:t.attr("data-bi-type")}}function ti(n){var t=[],i={areaName:n.areaName,slotNumber:n.slotNumber,templateName:n.templateName,contentId:n.contentId,contentName:n.name,contentSource:n.contentSource,product:n.product};return t.push(i),l(t)}function l(n){return JSON.stringify(n)}function ot(){var u="",f=["MC1","MSFPC"],i,n,t,r;Asimov.SignInStatus==0&&f.push("ANON");i={};n=f;try{try{window.varCustomerCookies&&window.varCustomerCookies.length>0&&(n=n.concat(window.varCustomerCookies))}catch(e){}for(t in n)i.hasOwnProperty(n[t])||(i[n[t]]="",r=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(n[t]).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")),r!=""&&(u+=n[t]+"="+r+";"))}catch(e){}return u}function ii(n){var t="",i,r;switch(n.tagName){case"A":case"AREA":t=n.href||"";break;case"IMG":t=oi(r);break;case"INPUT":i=n.type;r=window.event;i&&tt[i.toUpperCase()]&&(t=n.form?n.form.action||window.location.pathname:window.location.pathname)}return t}function ri(n){for(var r={},t,i;n;)if(!lt(n)){for(t in n.attributes)t&&n.attributes[t]&&(i=n.attributes[t].name,i&&i.toLowerCase().indexOf("ms.")==0&&(r[i]=n.attributes[t].value));n=n.parentElement||n.parentNode}return r}function ui(){var n={},i,r,t,u;if(navigator.plugins["Shockwave Flash"])n.installed=!0,i=navigator.plugins["Shockwave Flash"],n.version=i.description.split(" ")[2];else if(navigator.userAgent.indexOf("MSIE")!=-1)for(r=(new Date).getFullYear()-1992,t=r;t>0;t--)try{u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+t);n.installed=!0;n.version=t+".0";break}catch(f){}return n}function fi(){var n={},u,t,i,r;window.Silverlight!=undefined&&(n.enabled=!0);try{navigator.plugins["Silverlight Plug-In"]?(u=navigator.plugins["Silverlight Plug-In"],n.installed=!0,t=u.description,t&&(i=t.split("."),t=i[0]+"."+i[1],n.version=t)):navigator.userAgent.indexOf("MSIE")!=-1&&(r=new ActiveXObject("AgControl.AgControl"),r&&(n.installed=!0,n.version=ei(r)))}catch(f){}return n}function st(){for(var r={},n,u,i=$("meta"),t=0;t<i.length;t++)n=i[t],n.name&&(u=n.name.toLowerCase(),u.indexOf("ms.")==0&&(r[n.name]=n.content));return r}function ht(){var n="";return document.body&&document.body.clientWidth?n=document.body.clientWidth+"x"+document.body.clientHeight:document.documentElement&&document.documentElement.clientWidth?n=document.documentElement.clientWidth+"x"+document.documentElement.clientHeight:window.innerWidth&&(n=window.innerWidth+"x"+window.innerHeight),n}function ct(){if(navigator.cookieEnabled)return navigator.cookieEnabled;var n="MC0",t=g.getCookie(n);return t||(document.cookie=n+"="+d(),t=g.getCookie(n)),t?!0:!1}function ei(n){for(var t="",u=(new Date).getYear()-2004,r,i=u;i>0;i--)for(r=9;r>=0;r--)if(t=i+"."+r,n.IsVersionSupported(t))return t;return t}function oi(n){var i=n,t;if(i&&(t=$(i).closest("A"),t.length===1)){if(t[0].href)return t[0].href;if(t[0].src)return t[0].src}return""}function lt(n){if(!n||!n.attributes)return!1;try{var t=n.getAttribute("data-dc");return t!=null&&t!=undefined?t.toLowerCase()=="pii"?1:0:0}catch(i){return 0}}var a=!0,v=!0,y=!0,p=!0,w=!0,u,t=document.referrer,i=window.location.href,b=!1,k=!1,d=Asimov.createGuid,g=Asimov.cookie,at=Asimov.errorHandler,f=Asimov.ids,r=Asimov.vortexEvents,n=Asimov.utils,e=null,nt=!1,tt={BUTTON:!0,CHECKBOX:!0,RADIO:!0,RESET:!0,SUBMIT:!0};return{init:yt,capturePageView:h,captureContentView:ut,capturePartialView:wt,capturePageAction:kt,captureContentPageAction:bt,disableAutoPageView:function(){a=!1},disableAutoContentView:function(){v=!1},disableAutoClickTracking:function(){y=!1},disableMuidSync:function(){p=!1},disableJavascriptErrorTracker:function(){w=!1},enableCaptureAddInsInfo:function(){b=!0},enableCaptureAssetsPerfInfo:function(){k=!0},setReferrer:function(n){n!=null&&(t=n)},getReferer:function(){return t},setRequestUri:function(n){n&&(i=n)},getRequestUri:function(){return i},setSignInStatus:function(n){Asimov.SignInStatus=n===!0?1:0},setAppId:function(n){n&&r.setAppId(n)},setPageNameCallBack:function(n){e=n},disableDefaultContentNameCollecting:function(){nt=!0}}}();Asimov.service=function(){var t=Asimov.timespanHandler,n=function(n){function o(t,f,o){var h=t.getResponseHeader("Content-Length"),s={serviceName:n.serviceName,operationName:e,operationVersion:n.version&&n.version.toString(),httpStatusCode:t.status&&t.status.toString(),isSuccess:f,serviceErrorCode:!f&&t.responseJSON&&t.responseJSON.code&&!isNaN(t.responseJSON.code)?t.responseJSON.code:-1,requestUri:i.url,httpMethod:i.type,contentType:i.dataType,latencyMs:o,cV:t.getResponseHeader(Asimov.CorrelationVector.header)||r[Asimov.CorrelationVector.header],retryCount:u,responseSize:h&&parseInt(h),currentOperationName:n.currentOperationName||window.location.href};f||(s.errorMessage=Asimov.utils.stringifyField("errorMessage",t.errorThrown));n.customDataCallBack&&typeof n.customDataCallBack=="function"&&(s.customData=Asimov.utils.stringifyField("customData",n.customDataCallBack(t)));Asimov.vortexEvents.sendApiComplete(s)}function s(){var n=e+"_Retry_"+u;return t.recordTimeSpan(n),$.ajax(i).then(function(i,r,u){var f=t.recordTimeSpan(n,!0);return o(u,!0,f),u},function(i,r){var e=t.recordTimeSpan(n,!0),f;return o(i,!1,e),f=$.Deferred(),c>u&&(i.status===0||i.status>=500&&i.status<600)?(u++,setTimeout(function(){s().done(f.resolve).fail(f.reject)},50)):f.reject(i,r),f.promise()})}$.support.cors=!0;var r=n.additionalHeaders||{},f=n.body,h=f?JSON.stringify(f):n.data||undefined,c=n.maxRetry||0,u=0,l=$.noop,e=n.operationName||n.url,a=n.errorFormatter||function(n){return n},i={url:n.url,type:n.method,data:h,crossDomain:!0,headers:{},success:n.success,timeout:n.timeout,error:n.error,jsonp:n.jsonp,jsonpCallback:n.jsonpCallback,cache:n.cache,beforeSend:function(t){if(l(t),n.contractVersion&&t.setRequestHeader("MS-Contract-Version",n.contractVersion),r)for(var i in r)t.setRequestHeader(i,r[i])},defaultError:n.defaultError};return n.dataType!=="auto"&&(i.dataType=n.dataType||"json"),n.noCacheBusting||(i.cache=!1),n.contentType&&(i.headers["Content-Type"]=n.contentType),n.accept&&(i.headers.Accept=n.accept),n.xhrFields&&(i.xhrFields=n.xhrFields),s().then(function(n){return n},function(t){return a(t,n)})};return{post:function(t){return n($.extend({},t,{method:"POST"}))},get:function(t){return n($.extend({maxRetry:1},t,{method:"GET"}))},put:function(t){return n($.extend({},t,{method:"PUT"}))},del:function(t){return n($.extend({},t,{method:"DELETE"}))}}}();typeof define=="function"&&define.amd&&window.Asimov&&(!require.specified("jquery")&&window.jQuery&&(define.amd.jQuery=!1,define("jquery",[],function(){return window.jQuery})),define("Asimov",[],function(){return window.Asimov}),define("asimovEventSchemas",[],function(){return window.Asimov.asimovEventSchemas}),define("cookie",[],function(){return window.Asimov.cookie}),define("createGuid",[],function(){return window.Asimov.createGuid}),define("ids",[],function(){return window.Asimov.ids}),define("vortexEvents",[],function(){return window.Asimov.vortexEvents}),define("windowErrorHandler",[],function(){return window.Asimov.errorHandler}),define("timeSpanHandler",[],function(){return window.Asimov.timespanHandler}),define("clickstreamTracker",[],function(){return window.Asimov.clickstreamTracker}),define("jsll",["window"],function(n){return n.Asimov}),define("service",["window"],function(n){return n.Asimov.service}))