!function(){function a(a){if(!a.network||!a.siteId||!a.containerElementId)return void b.logError("network/sideId/containerElementId is missing in commentOptions, livefyre initialization failed.");a.isProdEnv="microsoft.fyre.co"===a.network,a.tokenServer=b.selectBackendUrl(a.isProdEnv);var d=b.getScriptUrl(),e=b.getScriptParentUrl(d),f=d.indexOf(".min.js")>-1,g=f&&".min"||"",h=a.isProdEnv?"master":"working",i=e+h+"/version.json";b.httpGetAsync(i,function(d){var f="0.0.0";if(d){var i=JSON.parse(d);f=i["git-version"]}var j="open-commenting.ui.docs."+f+g+".css",k="open-commenting.ui."+f+g+".css",l="open-commenting.ui."+f+g+".js",m={docs:e+h+"/"+j},n=b.safeGet(m,a.theme);b.loadCssFile(c.document.body,e+h+"/"+k),b.loadCssFile(c.document.body,n);var o=e+h+"/"+l;Livefyre.require([o],function(b){b.initializeLivefyre(a)},function(a){b.logError("Load "+l+" file failed."),b.logError(a)})})}var b=this,c=function(){return this}.call(null),d=c.window.console&&"function"==typeof c.window.console.error;b.logError=function(a){d&&c.window.console.error(a)},b.safeGet=function(a,b){return b&&a[b]},b.httpGetAsync=function(a,c){var d=new XMLHttpRequest,e="GET",f=/^[23]\d\d$/;d.open(e,a,!0),d.onreadystatechange=function(a){d.readyState===XMLHttpRequest.DONE&&(String(d.status).match(f)?c(d.responseText):b.logError("HTTP Request failure, statusText = "+d.statusText))},d.send(null)},b.loadCssFile=function(a,b){if(b){var d=c.document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",b),a.appendChild(d)}},b.loadJsFile=function(a,b){if(b){var d=c.document.createElement("script");d.setAttribute("type","text/javascript"),d.setAttribute("src",b),a.appendChild(d)}},b.selectBackendUrl=function(a){return a?"https://open-commenting.azurewebsites.net":"https://open-commenting-int.azurewebsites.net"},b.getScriptUrl=function(){var a="",b=document.getElementById("open-commenting-id");if(b)a=b.getAttribute("src");else for(var c=document.getElementsByTagName("script"),d=0;d<c.length;++d){var e=c[d],f=e.getAttribute("src");if(f&&f.indexOf("open-commenting.entry")>=0){a=f;break}}return a},b.getScriptParentUrl=function(a){var b=a.lastIndexOf("/")+1;return a.substring(0,b)},c.window.opencomment=function(c){c=c||{},c.serviceProvider&&"livefyre"!==c.serviceProvider?b.logError("The specified serviceProvider is not supported by Open Commenting Service!"):a(c)}}();